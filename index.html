<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Ta-Te-Ti</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">

<style>
* { box-sizing: border-box; font-family: 'Poppins', sans-serif; }

body {
    background: linear-gradient(135deg, #667eea, #764ba2);
    min-height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
    margin: 0;
}

.app {
    background: white;
    padding: 25px;
    border-radius: 20px;
    width: 360px;
    text-align: center;
    box-shadow: 0 20px 40px rgba(0,0,0,0.3);
}

h1 { margin-top: 0; }

.panel {
    display: flex;
    justify-content: space-between;
    margin-bottom: 10px;
    font-weight: 600;
}

#tablero {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 12px;
    margin: 20px 0;
}

.celda {
    width: 95px;
    height: 95px;
    font-size: 42px;
    border-radius: 15px;
    border: none;
    cursor: pointer;
    background: #f0f0f0;
    transition: transform 0.15s, background 0.2s;
}

.celda:hover { transform: scale(1.05); background: #e0e0ff; }
.celda:disabled { background: #ddd; cursor: default; }

select, button {
    width: 100%;
    padding: 10px;
    margin-top: 8px;
    font-size: 15px;
    border-radius: 10px;
    border: none;
}

button {
    background: #667eea;
    color: white;
    cursor: pointer;
}

button:hover { background: #5563d6; }

button.reset {
    background: #e74c3c;
}
button.reset:hover {
    background: #c0392b;
}

#mensaje { min-height: 24px; font-weight: 600; }

.confeti {
    position: fixed;
    width: 8px;
    height: 8px;
    animation: caer 1.5s linear forwards;
}

@keyframes caer {
    to { transform: translateY(100vh) rotate(360deg); opacity: 0; }
}
</style>
</head>

<body>

<div class="app">
    <h1>Ta-Te-Ti</h1>

    <div class="panel">
        <span>X: <span id="scoreX">0</span></span>
        <span>Empates: <span id="scoreE">0</span></span>
        <span>O: <span id="scoreO">0</span></span>
    </div>

    <select id="modo">
        <option value="ia">ðŸ¤– vs IA</option>
        <option value="2p">ðŸ‘¥ 2 Jugadores</option>
    </select>

    <select id="nivel">
        <option value="facil">ðŸŸ¢ FÃ¡cil</option>
        <option value="medio">ðŸŸ¡ Medio</option>
        <option value="dificil">ðŸ”´ DifÃ­cil</option>
    </select>

    <div id="tablero"></div>

    <div id="mensaje"></div>

    <button onclick="reiniciar()">Nueva partida</button>
    <button class="reset" onclick="reiniciarMarcador()">Reiniciar marcador</button>
</div>

<script>
let tablero = Array(9).fill("");
let turno = "X";
let activo = true;

let scoreX = 0, scoreO = 0, scoreE = 0;

const tableroDiv = document.getElementById("tablero");
const mensaje = document.getElementById("mensaje");

const scoreXEl = document.getElementById("scoreX");
const scoreOEl = document.getElementById("scoreO");
const scoreEEl = document.getElementById("scoreE");

for (let i = 0; i < 9; i++) {
    const b = document.createElement("button");
    b.className = "celda";
    b.onclick = () => jugar(i, b);
    tableroDiv.appendChild(b);
}

function jugar(i, b) {
    if (!activo || tablero[i]) return;

    tablero[i] = turno;
    b.textContent = turno;
    b.disabled = true;

    if (ganador(turno)) return finalizar(turno);
    if (empate()) return finalizar("E");

    turno = turno === "X" ? "O" : "X";

    if (turno === "O" && document.getElementById("modo").value === "ia") {
        setTimeout(turnoIA, 400);
    }
}

function turnoIA() {
    let libres = tablero
        .map((v,i)=>v===""?i:null)
        .filter(v=>v!==null);

    let mov = libres[Math.floor(Math.random()*libres.length)];
    jugar(mov, tableroDiv.children[mov]);
}

function ganador(j) {
    const c = [
        [0,1,2],[3,4,5],[6,7,8],
        [0,3,6],[1,4,7],[2,5,8],
        [0,4,8],[2,4,6]
    ];
    return c.some(l => l.every(i => tablero[i] === j));
}

function empate() {
    return tablero.every(c => c !== "");
}

function finalizar(r) {
    activo = false;

    if (r === "X") {
        scoreX++;
        mensaje.textContent = "ðŸŽ‰ GanÃ³ X";
        confeti();
    } else if (r === "O") {
        scoreO++;
        mensaje.textContent = "ðŸŽ‰ GanÃ³ O";
        confeti();
    } else {
        scoreE++;
        mensaje.textContent = "ðŸ˜ Empate";
    }

    actualizarMarcador();
}

function actualizarMarcador() {
    scoreXEl.textContent = scoreX;
    scoreOEl.textContent = scoreO;
    scoreEEl.textContent = scoreE;
}

function reiniciar() {
    tablero.fill("");
    turno = "X";
    activo = true;
    mensaje.textContent = "";
    [...tableroDiv.children].forEach(b => {
        b.textContent = "";
        b.disabled = false;
    });
}

function reiniciarMarcador() {
    const seguro = confirm(
        "Â¿Seguro que querÃ©s reiniciar el marcador?\nEsta acciÃ³n no se puede deshacer."
    );
    if (!seguro) return;

    scoreX = 0;
    scoreO = 0;
    scoreE = 0;
    actualizarMarcador();
}

function confeti() {
    for (let i = 0; i < 80; i++) {
        const c = document.createElement("div");
        c.className = "confeti";
        c.style.left = Math.random() * 100 + "vw";
        c.style.background = `hsl(${Math.random()*360},100%,50%)`;
        document.body.appendChild(c);
        setTimeout(() => c.remove(), 1500);
    }
}
</script>

</body>
</html>

